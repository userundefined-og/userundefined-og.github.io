

<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" /><title>Testing - Blog of the Dad</title><meta name="Description" content="Technical website about dawnofthe.dad and the like"><meta property="og:title" content="Testing" />
<meta property="og:description" content="Testing is almost universal in software development, yet it&rsquo;s common to treat it like a chore, or an after thought. Sure, test-driven development (TDD) is a means to influence what the public interface should look like by having the developer pretend the class already exists, and then implementing it to make the tests pass&hellip; but how often is TDD applied? And how often is it applied consistently? What&rsquo;s the magic test-coverage percentage that you (or your lead) are satisfied with, and why that number, in particular? What the heck is &ldquo;shifting left&rdquo;, and how religiously shoud you stick to the test pyramid? Can automated testing happen in production?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/testing/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-31T19:38:45-08:00" />
<meta property="article:modified_time" content="2024-03-31T19:38:45-08:00" /><meta property="og:site_name" content="Blog of the Dad" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Testing"/>
<meta name="twitter:description" content="Testing is almost universal in software development, yet it&rsquo;s common to treat it like a chore, or an after thought. Sure, test-driven development (TDD) is a means to influence what the public interface should look like by having the developer pretend the class already exists, and then implementing it to make the tests pass&hellip; but how often is TDD applied? And how often is it applied consistently? What&rsquo;s the magic test-coverage percentage that you (or your lead) are satisfied with, and why that number, in particular? What the heck is &ldquo;shifting left&rdquo;, and how religiously shoud you stick to the test pyramid? Can automated testing happen in production?"/>
      <meta name="twitter:site" content="@userundefinedrd"/>
<meta name="application-name" content="Blog of the Dad">
<meta name="apple-mobile-web-app-title" content="Blog of the Dad">

<meta name="theme-color" content="#f8f8f8"><meta name="twitter:creator" content="@userundefinedrd" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

<link rel="canonical" href="http://localhost:1313/posts/testing/" /><link rel="prev" href="http://localhost:1313/posts/all-different-variants/" />
<link rel="stylesheet" href="/css/main.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">{"@context": "https://schema.org","@type": "BlogPosting",
        "headline": "Testing",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http://localhost:1313/posts/testing/"
        },"genre": "posts","keywords":["Design"],"wordcount":  2142 ,
        "url": "http://localhost:1313/posts/testing/","datePublished": "2024-03-31T19:38:45-08:00","dateModified": "2024-03-31T19:38:45-08:00","publisher": {
            "@type": "Organization",
            "name": "Andrei"},"author": {
                "@type": "Person",
                "name": "Andrei",
                "url": "/"
            },"description": ""
    }</script></head>

<body header-desktop="" header-mobile=""><script type="text/javascript">
        function setTheme(theme) {
          document.body.setAttribute('theme', theme); 
          document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');
          if (theme === 'light') {
            document.documentElement.classList.remove('tw-dark')
          } else {
            document.documentElement.classList.add('tw-dark')
          }
          window.theme = theme;   
          window.isDark = window.theme !== 'light' 
        }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('' === 'light' || '' === 'dark' || '' === 'black') setTheme(''), saveTheme(''); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop print:!tw-hidden" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Blog of the Dad"><img
        class="logo"
        loading="lazy"
        src="android-chrome-192x192.png"
        srcset="android-chrome-192x192.png, android-chrome-192x192.png 1.5x, android-chrome-192x192.png 2x"
        title="android-chrome-192x192.png" height="36"   width="36" >Blog of the Dad</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item"
                    href="/posts/" > Posts </a><a class="menu-item"
                    href="/tags/" > Tags </a><a class="menu-item"
                    href="/categories/" > Categories </a><span class="menu-item delimiter"></span><button class="menu-item theme-switch" aria-label="Switch Theme">
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                </button></div>
        </div>
    </div>
</header><header class="mobile print:!tw-hidden" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Blog of the Dad"><img
        class="logo"
        loading="lazy"
        src="android-chrome-192x192.png"
        srcset="android-chrome-192x192.png, android-chrome-192x192.png 1.5x, android-chrome-192x192.png 2x"
        title="android-chrome-192x192.png" >Blog of the Dad</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="" >Posts</a><a class="menu-item" href="/tags/" title="" >Tags</a><a class="menu-item" href="/categories/" title="" >Categories</a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme">
                <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
            </button></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
            <div class="container"><div class="toc print:!tw-hidden" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#the-basics">The basics</a>
      <ul>
        <li><a href="#test-driven-development-tdd">Test Driven Development (TDD)</a></li>
        <li><a href="#test-pyramid">Test pyramid</a></li>
        <li><a href="#shifting-left">Shifting left</a></li>
      </ul>
    </li>
    <li><a href="#to-tdd-or-not-to-tdd">To TDD or not to TDD?</a></li>
    <li><a href="#when-to-test-things-extra-thoroughly">When to test things <em>extra</em> thoroughly</a>
      <ul>
        <li><a href="#connection-to-the-test-pyramid">Connection to the test pyramid</a></li>
      </ul>
    </li>
    <li><a href="#when-tests-become-necessary">When tests become necessary</a></li>
    <li><a href="#summing-things-up">Summing things up</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class="single-title animate__animated animate__flipInX">Testing</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><img src="http://localhost:1313/drd.jpg" alt="Andrei avatar" class="tw-inline-block tw-max-h-4 tw-rounded-full tw-translate-y-[-2px] tw-mr-1"><a href="/" title="Author" rel=" author" class="author">Andrei</a>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/testing/"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>Testing</a></span></div>
            <div class="post-meta-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;<time datetime="2024-03-31">2024-03-31</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime="2024-03-31">2024-03-31</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;2142 words&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;11 minutes&nbsp;</div>
        </div><div class="details toc print:!tw-block" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span class="details-icon"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#the-basics">The basics</a>
      <ul>
        <li><a href="#test-driven-development-tdd">Test Driven Development (TDD)</a></li>
        <li><a href="#test-pyramid">Test pyramid</a></li>
        <li><a href="#shifting-left">Shifting left</a></li>
      </ul>
    </li>
    <li><a href="#to-tdd-or-not-to-tdd">To TDD or not to TDD?</a></li>
    <li><a href="#when-to-test-things-extra-thoroughly">When to test things <em>extra</em> thoroughly</a>
      <ul>
        <li><a href="#connection-to-the-test-pyramid">Connection to the test pyramid</a></li>
      </ul>
    </li>
    <li><a href="#when-tests-become-necessary">When tests become necessary</a></li>
    <li><a href="#summing-things-up">Summing things up</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Testing is almost universal in software development, yet it&rsquo;s common to treat it like a chore, or an after thought. Sure, test-driven development (TDD) is a means to influence what the public interface should look like by having the developer pretend the class already exists, and then implementing it to make the tests pass&hellip; but how often is TDD applied? And how often is it applied <em>consistently</em>? What&rsquo;s the magic test-coverage percentage that you (or your lead) are satisfied with, and why that number, in particular? What the heck is &ldquo;shifting left&rdquo;, and how religiously shoud you stick to the test pyramid? Can automated testing happen in production?</p>
<p>Testing is a well studied subject, so in this post I&rsquo;m going to take a two-pronged approach to discussing these subjects: I&rsquo;ll use my <a href="https://dawnofthe.dad/crossword" target="_blank" rel="noopener noreferrer">crossword builder</a> as a case-study to explain these concepts, and I&rsquo;ll sprinkle in some of the things I&rsquo;ve learned to be true after a few decades in the industry. This is all of course just my opinion, but is generally something I&rsquo;ve found to be true. I&rsquo;ll assume that the reader is familiar with testing and software development, in general.</p>
<h2 id="the-basics" class="headerLink">
    <a href="#the-basics" class="header-mark"></a>The basics</h2><p>Testing is core to software development, and with good reason - tests help validate that the underlying system does what it ought to, and that the intended behavior is defended by tests, as things change. Refactoring a well-tested codebase is much less daunting than one that has few or no tests, because you can trust your tests to catch issues where your refactoring was flawed. Tests can serve as documentation, influence design, catch integration issues, and so on&hellip; but tests be a chore to write.</p>
<p>Let&rsquo;s blast through the kinds of tests commonly found in software:</p>
<ul>
<li><strong>Unit tests</strong> are the bread and butter of testing. Unit tests validate the behavior of a single unit of code, usually a single class or package. They are the fastest to run, and easiest to write. Most or all dependencies are mocked or faked out.</li>
<li><strong>Integration tests</strong> are the next step up, and span multiple units. These kinds of tests are meant to test interactions/integrations between those units, hence the name. Some dependencies may be still mocked out (e.g., RPC calls to external systems), but the goal is to get a bit closer to testing the real thing, while typically still sticking within the bounds of the binary that the units in question belong to. These tests are still <em>generally</em> fast to run, but may take a bit more effort to create.</li>
<li><strong>E2E tests</strong> can take many forms, but the general notion is that now you are testing across systems / binaries, not just units. These are the most realistic, and while a few interactions can still be faked out, most are close to what happens in production. These are the slowest to run, as you may end up having to spin up a sandbox to run all these binaries in, wire them up, and so on. This type of setup can get fairly complicated, making these kinds of tests the most difficult to create.</li>
</ul>
<h3 id="test-driven-development-tdd" class="headerLink">
    <a href="#test-driven-development-tdd" class="header-mark"></a>Test Driven Development (TDD)</h3><p>The idea behind TDD is that by writing tests first, rather than the code, the developer puts themselves in the shoes of the user of their code. The developer is thus forced to think about what the interface looks like. Such tests can also become a form of documentation of the underlying code. The newly created tests should fail, and the developer then goes and writes the code to make the already existing tests pass. And that&rsquo;s TTD in a nutshell.</p>
<h3 id="test-pyramid" class="headerLink">
    <a href="#test-pyramid" class="header-mark"></a>Test pyramid</h3><p>Looking at the three categories above, the test pyramid will tells us that we should have very many unit tests, some integration tests, and few E2E tests. The justification generally is along the lines of run time of these tests - unit tests are almost always lightning fast, and so are run frequently, integration tests are a bit more expensive, and might be run only occasionally during development, and E2E tests are often viewed as slow and painful, and so are run either before submitting changes, or less ideally, at some later point in the continuous integration pipeline.</p>
<h3 id="shifting-left" class="headerLink">
    <a href="#shifting-left" class="header-mark"></a>Shifting left</h3><p>The general idea is that the earlier a bug is caught, the better, because catching a bug in production is worse than catching it in staging/CI, catching a bug before submitting it to the codebase is better than in a CI, and catching a bug before even sending your code for review is even better. And so, the idea is to design systems so that more and more code is tested in the earlier phases (so, Unit &gt; Integration &gt; E2E test).</p>
<h2 id="to-tdd-or-not-to-tdd" class="headerLink">
    <a href="#to-tdd-or-not-to-tdd" class="header-mark"></a>To TDD or not to TDD?</h2><p>As with many things with code, one should view TDD as one of the tools in their toolbox, and apply it accordingly. For example, if you&rsquo;re starting on a fresh code base and aren&rsquo;t sure what the interface should look like, TDD is a good approach to get the interface and tests bootstrapped, and possibly to drive the majority of development.</p>
<p>Personally, I find that by the time I get to coding, I have a pretty good idea of what it is that I want to build, and to be perfectly honest, usually add tests after the fact, which is of course a big &ldquo;no&rdquo; for TDD. The cases where I do find TDD bring huge value is for fixing bugs. Suppose you find a bug in your code, and you&rsquo;ve narrowed it down to a subset of the system. Now is a good opportunity to apply a form of TDD (I suppose it&rsquo;s more like &ldquo;test driven debugging&rdquo;):</p>
<ul>
<li><strong>Replicate the failing behavior by writing a test</strong>. The test should describe the preconditions for the bug and the expected result. The test may be a unit test, but could be an integration test, or even an E2E test. The latter can become a necessesity as the bugs get more and more subtle, because you don&rsquo;t know where exactly the bug may be.</li>
<li><strong>Run the test</strong>. If you got the preconditions right, your test should reproduce the bug and fail, because the test expects the correct result, which your system under test isn&rsquo;t producing (yet).</li>
<li><strong>Fix it</strong>. Root cause the issue, fix it, run the test, and get it to pass. Oh yeah, and don&rsquo;t forget to submit that fix.</li>
</ul>
<p>Tests added to help fix bugs following the pattern above serve multiple purposes: they help confirm that the bug is fixed (and possibly help root cause by being easily repeatable during this phase), <strong>and they serve as a lasting protection against the same bug resurfacing in the future</strong>. They also serve as a form of documentation for a potentially subtle use-case you hadn&rsquo;t considered before. I found this pattern particularly useful for patching up subtle issues with the underlying CSP solver that powers the crossword builder and the sudoku solver.</p>
<p>Even if you find TDD isn&rsquo;t something you use every day to design your code, you should consider it as a useful tool under other circumstances, like fixing and preventing recurrence of bugs.</p>
<h2 id="when-to-test-things-extra-thoroughly" class="headerLink">
    <a href="#when-to-test-things-extra-thoroughly" class="header-mark"></a>When to test things <em>extra</em> thoroughly</h2><p>Often times teams will set high code coverage metrics, and these are generally a good rule of thumb to ensure that tests exist, but a single number, like 85% coverage, only covers the basic fact that tests exist and exercise at least that fraction of the lines of code, by definition. Coverage won&rsquo;t tell you if your tests are of high quality, or whether there are areas where a higher degree of coverage may be beneficial (and conversely, can be a not-so-useful nag for trivial code, like a slew of getters and setters).</p>
<p>So when do you know that a certain piece of code deserves to be held to a higher bar? My general rule of thumb is a combination of impact that a flaw could have, and complexity of logic in question. For example, if the logic is mission-critical, you may want to be extra thorough in the kinds of scenarios you want to cover with tests. The same approach applies to subtle logic, like a complex algorithm - even 100% coverage may not truly catch all the quirks and edge-cases, and you&rsquo;ll want to run many different kinds of inputs against such code.</p>
<p>In the case of my crossword builder, the core solver logic has near 100% code coverage and is exercised by N-queens, sudoku and a few crossword puzzles, to ensure that refactorings or changes in general don&rsquo;t introduce regressions. I even have some rudimenary load tests to see if things slow down too much as the code evolves.</p>
<p>As I alluded above, there may be cases where thorough code coverage is not worth the cost of introducing it. In my case much of the HTTP server is largely boilerplate that changes rarely, and is easy to fully exercise by just bringing up the website. Of course if this was a critical website I would introduce coverage to avoid outages, but being my hobby site with low traffic this felt overkill.</p>
<h3 id="connection-to-the-test-pyramid" class="headerLink">
    <a href="#connection-to-the-test-pyramid" class="header-mark"></a>Connection to the test pyramid</h3><p>I find that the general pattern applies to all kinds of tests, where you weigh the benefit of having the test vs the cost of writing it. I&rsquo;d go even further to state that <strong>this</strong> is often the reason for the test pyramid to be unit-test heavy, and E2E test light - not just because the former are blazing fast and the latter can be very slow to run, but because the cost/benefit trade-off doesn&rsquo;t justify investing that much time into the latter. And, of course, this all depends on how critical and subtle the E2E behavior is. Sometimes you may still wish to spend a significant amount of effort to put together an E2E test, if the functionality in question is that critical to validate.</p>
<h2 id="when-tests-become-necessary" class="headerLink">
    <a href="#when-tests-become-necessary" class="header-mark"></a>When tests become necessary</h2><p>While you may want to cover subtle or critical bits of code with tests proactively, to prevent subtle or critical regressions, there are other cases where lack of tests can become a significant speed-bump or blocker to the overall development process. In this section I&rsquo;ll focus more on maintainability and extensibility of the underlying code that is protected by tests.</p>
<p>The core solver is my <strong>4th rewrite</strong>, but this time around I really invested the time to cover the logic with tests, and doing so helped me ensure correctness as I&rsquo;ve introduced many new features, like conflict-directed backjumping, which is fairly complex and required significantly rewiring things. While this may not be my final rewrite, it&rsquo;s certainly the easiest to maintain and extend so far, and test coverage is one of the main reasons why this is the case.</p>
<p>Another example where tests became necessary is the crossword builder frontend - its logic was originally in a monolithic JS file, without tests. While this approach worked fine for the sudoku solvers (both the classic and NxN), the complexity of allowing the user to build the grid, encode/decode all kinds of state, fill the grid and supporting all the other bells and whistles blew up quickly. As a result, I&rsquo;ve ported JS to TypeScript, where I was able to cleanly factor the code into classes, with proper unit and integration tests. And while the features themselves are largely simpler than the core solver, the same argument applies here - I am less worried about making larger structural changes as I know that my code coverage will catch obvious flaws. And similarly to the HTTP boilerplate of the backend, I didn&rsquo;t invest time to add tests validating rendering or automating interactions. This would definitely add <em>some</em> value by preventing the need for manual tests, but for now, to me, the cost wasn&rsquo;t worth the benefit, at least for now.</p>
<p>Coming back to shifting left - I could say that the TypeScript rewrite essentially accomplished that, removing the need for most of the manual tests and shifting tests left, towards unit and integration tests. A similar argument can be said about incrementally adding tests to capture bugs (as part of fixing them) - now these bugs are part of the unit/integration test suite, which is basically free to run, and previously reproducing such bugs would have required significant manual effort.</p>
<h2 id="summing-things-up" class="headerLink">
    <a href="#summing-things-up" class="header-mark"></a>Summing things up</h2><p>Tests take time to write, and generally the more E2E they are, the longer they take to write. I&rsquo;ve found the impact/complexity rule of thumb to be a solid guideline to know when light coverage is good enough, or you want to go the extra mile and save yourself the debugging headache (or the inevitable production outage) down the line. In the same vein of thought, you can use tests as a means to make your development easier, by shifting left (and thus making your future testing more efficient), covering regressions, and so on.</p></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-03-31</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line print:!tw-hidden">
            <div class="post-info-md"></div>
            <div class="post-info-share"></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg>&nbsp;<a href="/tags/design/">Design</a></section>
        <section class="print:!tw-hidden">
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav print:tw-hidden"><a href="/posts/all-different-variants/" class="prev" rel="prev" title="All Different Variants"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>All Different Variants</a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.124.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg> DoIt</a>
                </div><div class="footer-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532 0-200-89.451-200-200 0-110.531 89.451-200 200-200 110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43 0-140.484-61.425-140.484-141.567 0-79.152 60.275-139.401 139.762-139.401 55.531 0 88.738 26.62 97.593 34.779a11.965 11.965 0 0 1 1.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303 0-77.916 35.33-77.916 80.082 0 41.589 26.888 83.692 78.277 83.692 32.657 0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947 0 0 1-1.152 15.518z"/></svg>2024<span class="author">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">Andrei</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons" class="print:!tw-hidden"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"/></svg>
        </a>
    </div><div class="assets"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10000},"comment":{}};</script><script
    src="/lib/clipboard/clipboard.min.js"
    
  ></script><script
    src="/js/theme.min.js"
    
      defer
    
  ></script></div>
</body>

</html>
